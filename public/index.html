<!DOCTYPE html>
<html>
<head>
    <title>Open Data Mannheim - Parken</title>
    <style>
        html, body, #map {
            height: 100%;
            margin: 0px;
            padding: 0px
        }
        #logo {
            position: fixed;
            top: 15px;
            left: 50px;
        }
    </style>
    <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.8/mapbox.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.8/mapbox.css' rel='stylesheet' />
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script>
    $(function(){
        function initialize() {
            L.mapbox.accessToken = 'pk.eyJ1Ijoic2lsc2hhIiwiYSI6InZwUUh4NVEifQ.anjxmt-7tZqeVtKhD5th4w';
            // Create a map in the div #map
            var map = L.mapbox.map('map', 'silsha.lp9meh6a');
            
            var marker;
            $.getJSON('/data.json', function (data) {
                $.each( data, function (i, location){
                    if("location" in location) {
                        if (location.free == 0)
                            var color = "FF0000";
                        else if (location.free <= 100)
                            var color = "FFA500";
                        else 
                            var color = "00FF00";

                        L.mapbox.featureLayer({
                            type: 'Feature',
                            geometry: {
                                type: 'Point',
                                coordinates: [
                                  location.location.lng,
                                  location.location.lat 
                                ]
                            },
                            properties: {
                                title: location.name,
                                description: 'Freie PlÃ¤tze: ' + location.free,
                                'marker-size': 'large',
                                'marker-color': color,

                            }
                        }).addTo(map);

                    }
                });
            });
        }

        initialize();
        })

    </script>
</head>
<body>
    <div id="map"></div>
    <div id="logo"><a href="https://fnordcordia.eu"><img src="/logo.png"></a></div>
</body>
</html>